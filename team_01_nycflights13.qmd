---
title: "Lab 04"
author: Wong Chun Owen
format:
  html:
    toc: true
---

# Collaborators
![](collaborators.png)

# Task 1: Establishing a Productive Software Environment for the Project
```{r}
#| label: setup
#| include: false

library(knitr)
library(kableExtra)
library(DBI)
con_nycflights13 <- DBI::dbConnect(odbc::odbc(), dsn = "nycflights13")
```

```{sql}
#| connection: con_nycflights13
#| eval: true
#| echo: false

-- Drop the table if it exists
DROP TABLE IF EXISTS airlines CASCADE;

-- Create the airlines table with appropriate columns
CREATE TABLE airlines (
    carrier CHAR(2),
    name VARCHAR(255),
    PRIMARY KEY (carrier)
);

-- Import data from the CSV file
COPY airlines
FROM 'C:/Users/phoin/Desktop/airlines.csv'
CSV HEADER;

-- Drop the table if it exists
DROP TABLE IF EXISTS airports CASCADE;

-- Create the airports table with appropriate columns
CREATE TABLE airports (
    faa CHAR(3),
    name VARCHAR(255),
    lat NUMERIC,
    lon NUMERIC,
    alt INT,
    tz INT,
    dst CHAR(1),
    tzone VARCHAR(255),
    PRIMARY KEY (faa)
);

-- Import data from the CSV file
COPY airports(faa, name, lat, lon, alt, tz, dst, tzone)
FROM 'C:/Users/phoin/Desktop/airports.csv'
CSV HEADER;

-- Drop the table if it exists
DROP TABLE IF EXISTS flights CASCADE;

-- Create the flights table with appropriate columns
CREATE TABLE flights (
    year INT,
    month INT,
    day INT,
    dep_time INT,
    sched_dep_time INT,
    dep_delay INT,
    arr_time INT,
    sched_arr_time INT,
    arr_delay INT,
    carrier CHAR(2),
    flight INT,
    tailnum VARCHAR(6),
    origin CHAR(3),
    dest CHAR(3),
    air_time INT,
    distance INT,
    hour INT,
    minute INT,
    time_hour TIMESTAMP,
    PRIMARY KEY (carrier, flight, time_hour)
);

-- Import data from the CSV file
COPY flights(year, month, day, dep_time, sched_dep_time, dep_delay, arr_time, sched_arr_time, arr_delay, carrier, flight, tailnum, origin, dest, air_time, distance, hour, minute, time_hour)
FROM 'C:/Users/phoin/Desktop/flights.csv'
CSV HEADER;


-- Drop the table if it exists
DROP TABLE IF EXISTS planes CASCADE;
```
```{sql}
#| connection: con_nycflights13
#| eval: true
#| echo: true
-- Create the planes table with appropriate columns
CREATE TABLE planes (
    tailnum VARCHAR(255) PRIMARY KEY,
    year INT,
    type VARCHAR(255),
    manufacturer VARCHAR(255),
    model VARCHAR(255),
    engines INT,
    seats INT,
    speed INT,
    engine VARCHAR(255)
);

-- Import data from the CSV file
COPY planes(tailnum, year, type, manufacturer, model, engines, seats, speed, engine)
FROM 'C:/Users/phoin/Desktop/planes.csv'
CSV HEADER;
```
```{sql}
#| connection: con_nycflights13
#| eval: true
#| echo: false
#| 
-- Drop the table if it exists
DROP TABLE IF EXISTS weather CASCADE;

-- Create the weather table with appropriate columns
CREATE TABLE weather (
    origin CHAR(3),
    year INT,
    month INT,
    day INT,
    hour INT,
    temp NUMERIC,
    dewp NUMERIC,
    humid NUMERIC,
    wind_dir INT,
    wind_speed NUMERIC,
    wind_gust NUMERIC,
    precip NUMERIC,
    pressure NUMERIC,
    visib NUMERIC,
    time_hour TIMESTAMP,
    PRIMARY KEY (origin, time_hour)
);

-- Import data from the CSV file
COPY weather(origin, year, month, day, hour, temp, dewp, humid, wind_dir, wind_speed, wind_gust, precip, pressure, visib, time_hour)
FROM 'C:/Users/phoin/Desktop/weather.csv'
CSV HEADER;

ALTER TABLE flights
ADD FOREIGN KEY (carrier) REFERENCES airlines (carrier),
ADD FOREIGN KEY (origin) REFERENCES airports (faa),
ADD FOREIGN KEY (dest) REFERENCES airports (faa),
ADD FOREIGN KEY (tailnum) REFERENCES planes (tailnum);
ALTER TABLE weather
ADD FOREIGN KEY (origin) REFERENCES airports (faa);
```

# Task 2: Aggregating Information from the `flights` Table

...

# Task 3: Exploring Flights from New York City to Chicago

...

# Task 4: Uncovering Associations between Weather and Flight Operations

